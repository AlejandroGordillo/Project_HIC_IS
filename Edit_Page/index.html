<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit_Page</title>
    <!-- Fonts -->
    <link href="https://fonts.cdnfonts.com/css/futura-pt" rel="stylesheet">
    <!-- Boxicons -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- Enlace a CSS-->
    <link rel="stylesheet" href="style.css">
    <!-- Enlace a Tinycme -->
    <script src="./tinymce/tinymce.min.js" referrerpolicy="origin"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <header class="header">

        <nav class="header-navbar"> 
            <button class="nav-menu_toggle">
                <span class="line"></span>
                <span class="line"></span>
                <span class="line"></span>
            </button>

            <a href="#" class="logo">
                <img src="Resources/LogoHIC.png">
            </a>

            <div class="nav_menu">
                <button class="nav-menu_close">
                    <i class='bx bx-x'></i>
                </button>

                <ul class="nav_list">
                    <li>
                        <a href="#" class="nav_link">Inicio</a>
                    </li>
                    <li>
                        <a href="#" class="nav_link">Agendar Cita</a>
                    </li>
                    <li>
                        <a href="#" class="nav_link">Cirugia Ambulatoria</a>
                    </li>
                    <li>
                        <a href="#" class="nav_link">Especialidades Pediatricas</a>
                    </li>
                    <li>
                        <a href="#" class="nav_link">CIAPPI</a>
                    </li>
                    <li>
                        <a href="#" class="nav_link">Telesalud</a>
                    </li>
                    <li>
                        <a href="#" class="nav_link">Noticias</a>
                    </li>
                    <li>
                        <a href="#" class="nav_link">Contacto</a>
                    </li>
                </ul>
            </div>

            <div class="right-content">
                <a href="http://localhost/Project_HIC_IS/Login_Register/" class="nav-btn">Sign In</a>

            </div>

        </nav>
        
    </header>

    <main>
        <header class="header-main">
            <h1>[ Titulo ]</h1>
        </header>
        
        <section class="main-section">
            <div class="image-placeholder">
                <p>Inserte Imagen</p>
                <!-- Example Code -->
                <!-- <form>
                    <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" style="height: 85px;" placeholder="Insert text"></textarea>
                    <input type="file" id="imagen" name="imagen" accept="image/*">
                    <div class="mb-3" bis_skin_checked="1">
                    <label for="exampleInputEmail1" class="form-label">Email address</label>
                    <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
                    <div id="emailHelp" class="form-text" bis_skin_checked="1">We'll never share your email with anyone else.</div>
                    </div>
                    <div class="mb-3" bis_skin_checked="1">
                    <label for="exampleInputPassword1" class="form-label">Password</label>
                    <input type="password" class="form-control" id="exampleInputPassword1">
                    </div>
                    <div class="mb-3 form-check" bis_skin_checked="1">
                    <input type="checkbox" class="form-check-input" id="exampleCheck1">
                    <label class="form-check-label" for="exampleCheck1">Check me out</label>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form> -->
                    
                <!-- End Example Code -->
            </div>
    
            <div class="editor-section">
                <div class="editor">
                    <form id="formulario" class="formulario">
                        <textarea id="editor" placeholder="Editar Texto ..."></textarea>
                        <br>
                        <input type="radio" name="intereses" value="Tecnologia"> <label>Tecnologia</label>
                        <input type="radio" name="intereses" value="Ciencias"> <label>Ciencias</label>
                        <input type="radio" name="intereses" value="Cardiovascular"> <label>Cardiovascular</label>
                        <input type="radio" name="intereses" value="Nutricion"> <label>Nutricion</label>
                        <div class="editor-toolbar">
                            <!-- <button><img src="Resources/youTube.png" alt="YT" class="icon-editor"></button>
                            <button><img src="Resources/googleDrive.png" alt="Drive" class="icon-editor"></button>
                            <button><img src="Resources/chain.png" alt="Enlace" class="icon-editor"></button>
                            <button><img src="Resources/upload.png" alt="Subir" class="icon-editor"></button> -->
                            <button class="publish-button" type="submit">Publicar</button>
                        </div>
                    </form>
                    
                </div>
    
                <div class="sidebar">
                    <div class="recommendations">
                        <h3>Recomendados</h3>
                        <div class="recommendation-button">
                            <span>Elegir Noticia</span>
                            <img src="Resources/folder.png" alt="Icono Descargar">
                        </div>
                        <div class="recommendation-button">
                            <span>Elegir Noticia</span>
                            <img src="Resources/folder.png" alt="Icono Descargar">
                        </div>
                    </div>
                    <div class="logo-cabezas">
                        <img src="Resources/verde.png" alt="Cactus Logo">
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="section footer">
        <div class="container">
            <div class="footer_container grid">
                <div class="footer_box">
                    <div class="footer_logo footer_title">
                        <a href="#">
                            <img src="Resources/LogoHIC.png" alt="">
                        </a>
                    </div>

                    <p class="footer_text">
                        Llama a 973 7756 y 973 7757 <br>ext. 404 y 417
                        <br>Avenida Alejandro von Humboldt 11431 <br> Garita de Otay, 22430 Tijuana, Baja California
                    </p>
                </div>

                <div class="footer_box">
                    <div class="footer_title">
                        <h3>Important Link</h3>
                    </div>

                    <ul class="footer_link">
                        <li>
                            <a href="#">News</a>
                        </li>
                        <li>
                            <a href="#">Career</a>
                        </li>
                        <li>
                            <a href="#">Technology</a>
                        </li>
                        <li>
                            <a href="#">Startup</a>
                        </li>
                        <li>
                            <a href="#">Gadget</a>
                        </li>
                    </ul>
                </div>

                <div class="footer_box">
                    <div class="footer_title">
                        <h3>Browse by Tag</h3>
                    </div>

                    <ul class="tag_list">
                        <li>
                            <a href="#">Oficial</a>
                        </li>
                        <li>
                            <a href="#">Pediatria</a>
                        </li>
                        <li>
                            <a href="#">Nutricion</a>
                        </li>
                        <li>
                            <a href="#">Terapia Fisica</a>
                        </li>
                        <li>
                            <a href="#">Psicología</a>
                        </li>
                        <li>
                            <a href="#">Cardiología</a>
                        </li>
                        <li>
                            <a href="#">Odontopediatría</a>
                        </li>
                        <li>
                            <a href="#">Urología</a>
                        </li>
                    </ul>
                </div>

                <div class="footer_box">
                    <div class=" footer_title">
                        <h3>
                            Social Media
                        </h3>
                    </div>
                    
                    <ul class="social_list grid">
                        <li>
                            <a href="https://www.facebook.com/hicoficial/">
                                <i class='bx bxl-facebook' ></i>
                                <span class="span">Facebook</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.instagram.com/hicoficial/">
                                <i class='bx bxl-instagram' ></i>
                                <span class="span">Instagram</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.youtube.com/user/HICoficial">
                                <i class='bx bxl-youtube' ></i>
                                <span class="span">YouTube</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://x.com/hicoficial">
                                <i class='bx bxl-twitter' ></i>
                                <span class="span">Twitter</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="copyright">
            <div class="container">
                <p>
                    Copyright &copy; 2024 Hospital Infantil de las Californias. all Rights Reseved.
                </p>
            </div>
        </div>
    </footer>

    <!-- Enlace a javaScript-->
    <script src="script.js"></script>


    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const titleElement = document.querySelector('.header-main h1');
        
        // Hacer el título editable
        titleElement.contentEditable = true;
        titleElement.addEventListener('focus', function() {
            if (this.textContent === '[ Titulo ]') {
                this.textContent = '';
            }
        });
    
        titleElement.addEventListener('blur', function() {
            if (this.textContent.trim() === '') {
                this.textContent = '[ Titulo ]';
            }
        });
    
        // Manejo de imágenes
        const imagePlaceholder = document.querySelector('.image-placeholder');
        
        imagePlaceholder.addEventListener('click', function() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const img = document.createElement('img');
                        img.src = event.target.result;
                        img.style.maxWidth = '100%';
                        img.style.maxHeight = '100%';
                        img.style.borderRadius = '10px';
                        
                        imagePlaceholder.innerHTML = '';
                        imagePlaceholder.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                }
            };
            
            input.click();
        });
    
        // Modificar el listener del formulario existente
        const formulario = document.getElementById('formulario');
        formulario.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const contenido = tinymce.activeEditor.getContent();
            const titulo = titleElement.textContent === '[ Titulo ]' ? '' : titleElement.textContent;
            const imagePlaceholder = document.querySelector('.image-placeholder');
            const imagen = imagePlaceholder.querySelector('img')?.src || null;
            
            // Validaciones
            if (!titulo.trim()) {
                alert('Por favor, ingrese un título');
                return;
            }
    
            if (!imagen) {
                alert('Por favor, seleccione una imagen');
                return;
            }
    
            try {
                const response = await fetch('../article-handler.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        titulo: titulo,
                        contenido: contenido,
                        imagen: imagen,
                        categoria: document.querySelector('input[name="categoria"]:checked')?.value || '',
                        estado: 'publicado'
                    })
                });
    
                if (!response.ok) throw new Error('Error al publicar');
    
                const data = await response.json();
                if (data.success) {
                    alert('Artículo publicado exitosamente');
                    titleElement.textContent = '[ Titulo ]';
                    imagePlaceholder.innerHTML = 'Inserte Imagen';
                    tinymce.activeEditor.setContent('');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error al publicar el artículo');
            }
        });
    });
    </script>
    
</body>
</html>
